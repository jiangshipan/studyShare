package com.jsp.studyShare.controller;import com.jsp.studyShare.Service.CategoryService;import com.jsp.studyShare.model.Category;import com.jsp.studyShare.model.Response;import com.jsp.studyShare.utils.JsonUtil;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.util.StringUtils;import org.springframework.web.bind.annotation.*;import java.util.List;import java.util.Map;@RequestMapping("/category")@Controllerpublic class CategoryController {    private static final Logger logger = LoggerFactory.getLogger(UserController.class);    @Autowired    private CategoryService categoryService;    @RequestMapping(path = "/add", method = {RequestMethod.POST})    @ResponseBody    public Response addCategory(@RequestBody String jsonStr) {        try {            Map<String, String> map = JsonUtil.strToMap(jsonStr);            String cname = map.get("cname");            Category category = categoryService.findCategoryByCname(cname);            if (category != null) {                //若被禁用，修改为1                if (category.getStatus() == 0) {                    categoryService.updateCategroyStatus(category.getCid(), 1);                    return new Response(0, "新增成功");                }                return  new Response(1, "该分类已经存在");            }            categoryService.addCategory(cname);            return new Response(0, "新增成功");        } catch (Exception e) {            logger.error("addCategory error:", e);            return new Response(1, "新增失败");        }    }    @RequestMapping(path = "/dele", method = {RequestMethod.GET})    @ResponseBody    public Response deleCategory(@RequestParam("cid") int cid) {        try {            categoryService.deleCategory(cid);            return new Response(0, "删除成功");        } catch (Exception e) {            logger.error("deleCategory error:", e);            return new Response(1, "删除失败");        }    }    @RequestMapping(path = "/get", method = {RequestMethod.GET})    @ResponseBody    public Response getCategory() {        try {            List<Category> category = categoryService.findCategory();            return new Response(0, "获取成功", category);        } catch (Exception e) {            logger.error("getCategory error:", e);            return new Response(1, "查询失败");        }    }    @RequestMapping(path = "/update", method = {RequestMethod.POST})    @ResponseBody    public Response updateCategory(@RequestBody String jsonStr) {        try {            Map<String, String> map = JsonUtil.strToMap(jsonStr);            String cid = map.get("cid");            if (StringUtils.isEmpty(cid)) {                return new Response(1, "cid不能为空");            }            String cname = map.get("cname");            String result = categoryService.updateCategroy(Integer.parseInt(cid), cname);            if (result.equals("修改成功")) {                return new Response(0, result);            }            return new Response(1, result);        } catch (Exception e) {            logger.error("updateCategory error:", e);            return new Response(1,"修改失败");        }    }}